--SELECT Befehle fuer einzelne Tabellen:
SELECT * FROM Mitarbeiter;
SELECT * FROM Ort;
SELECT * FROM Auto;
SELECT * FROM Kunde;
SELECT * FROM Gesuch;
SELECT * FROM Angebot;
SELECT * FROM Beziehung_Strecken;
SELECT * FROM Beziehung_Vermittlung;
SELECT * FROM Beziehung_Auto_Kunde;

--SELECT Namen Abfragen:--
--Mit Wildcards
SELECT Name FROM Kunde WHERE Name LIKE 'M%';
 --Mit 1 Anfangsbuchstaben
SELECT Name FROM Kunde WHERE REGEXP_LIKE(Name,'M');
--Mit mehreren Anfangsbuchstaben z.B "M und K", ' wichtig!
SELECT Name FROM Kunde WHERE REGEXP_LIKE(Name,'[MK]');

--SELECT COUNT Abfragen:--
--Anzahl der Angebote
SELECT Count(AngebotNr) "Anzahl der Angebote" FROM Angebot;
 --Anzahl der Angebote
SELECT Count(GesuchNr) "Anzahl der Gesuche" FROM Gesuch;

--SELECT ORDER BY Abfragen:
--Angebote aufsteigend nach Startort sortieren:
SELECT * FROM Angebot ORDER BY Ort_Start ASC;
--Angebote absteigend nach Startort sortieren:
SELECT * FROM Angebot ORDER BY Ort_Start DESC;

--SELECT: "GROUP BY", gruppieren mit z.B  :
SELECT Count(AngebotNr),Ort_Start FROM Angebot GROUP BY Ort_Start;
SELECT Count(AngebotNr),Ort_Start FROM Angebot GROUP BY Ort_Start HAVING Ort_Start ='Mannheim' OR Ort_Start = 'Dortmund';
SELECT * FROM Angebot WHERE Ort_Start = 'Mannheim' AND Abfahrt < TO_DATE('01-06-15 10:30', 'DD-MM-YY HH24:MI');

--SELECT: Zeitvergleiche:
SELECT * FROM Angebot WHERE Abfahrt > TO_DATE('01-06-15 10:30', 'DD-MM-YY HH24:MI');
SELECT * FROM Angebot WHERE To_Char(Abfahrt,'HH24:MI') > '09:30';

--SELECT: Startort und Über-Standorte abfragen:
SELECT * FROM angebot WHERE ort_start='Mannheim' AND (ort_ziel='Koeln' OR ort_ueber='Koeln');
SELECT Ort_Start,ort_ueber,ort_ziel FROM angebot WHERE ort_start='Mannheim' AND (ort_ziel='Koeln' OR ort_ueber='Koeln') ;

--SELECT: Von welchem Mitarbeiter ein Angebot erfasst wurde abfragen:
SELECT * from angebot WHERE erfasst_von= (SELECT PersonalNr FROM mitarbeiter WHERE name='Mueller');

SELECT * FROM angebot WHERE  Abfahrt<TO_DATE( '1-6-15', 'DD-MM-YY') OR Fruehste_Startzeit<TO_DATE( '1-6-15', 'DD-MM-YY');
SELECT * FROM angebot,gesuch WHERE angebot.ort_start = gesuch.ort_start AND  gesuch.ort_start='Mannheim';

--SELECT: Alle durchgefuehrten fahrten // Alle durchgefuehrten Fahrten Beziehung_Vermittlung.Fahrt_duerchgefuehrt=1// Vermittelte Fahrten Beziehung_Vermittlung.Fahrt_duerchgefuehrt=0
SELECT angebot.Ort_Start,angebot.ort_Ziel, angebot.Abfahrt, Beziehung_Vermittlung.Fahrt_duerchgefuehrt FROM  angebot,Beziehung_Vermittlung WHERE Beziehung_Vermittlung.Fahrt_duerchgefuehrt=1
AND angebot.Angebotnr = Beziehung_Vermittlung.AngebotNr;

--SELECT: Alle Gesuche, mit der Distance > 100 KM:
SELECT Gesuch.ort_start, Gesuch.ort_ziel,Beziehung_Strecken.km FROM Gesuch,Beziehung_Strecken WHERE Beziehung_Strecken.km>100 AND Beziehung_Strecken.ort_start = Gesuch.ort_start
AND Beziehung_Strecken.ort_ziel = Gesuch.ort_ziel;

--SELECT: Laenge einer bestimmten Strecke eines Angebotes nachfragen:
SELECT Beziehung_Strecken.km "Laenge der Strecke", Angebot.Ort_Start, Angebot.Ort_Ziel FROM Angebot, Beziehung_Strecken
WHERE Angebot.Ort_Start = 'Mannheim' AND Angebot.Ort_Ziel ='Muenchen' AND Beziehung_Strecken.Ort_Start = Angebot.Ort_Start
AND Beziehung_Strecken.Ort_Ziel = Angebot.Ort_Ziel;

--SELECT: Alle Fahrer:
SELECT distinct kunde.name FROM Kunde, Angebot WHERE Kunde.KundenNr = Angebot.Bietender;

--SELECT: Alle Fahrer die ein Auto besitzen:
SELECT Kunde.name , kunde.vorname FROM Kunde, Beziehung_Auto_Kunde WHERE kunde.Kundennr = Beziehung_Auto_Kunde.kundennr;

--SELECT: Auto-Modell über KundenNr abfragen:
SELECT Kunde.KundenNr, Auto.Modell FROM Beziehung_Auto_Kunde, Kunde, Auto
WHERE Kunde.KundenNr = Beziehung_Auto_Kunde.KundenNr AND Beziehung_Auto_Kunde.Kennzeichen = Auto.Kennzeichen;

